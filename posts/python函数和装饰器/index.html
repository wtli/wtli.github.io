<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title> Python函数和装饰器 - wtlinux-职业生涯记录</title>
  <meta name="description" content="wtlinux-职业生涯记录" />
  <meta property="og:title" content="Python函数和装饰器" />
  <meta name="twitter:title" content="Python函数和装饰器" />
  <meta name="description" content="python函数及装饰器">
  <meta property="og:description" content="python函数及装饰器">
  <meta name="twitter:description" content="python函数及装饰器">
  <meta name="author" content="wangtian"/>
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://www.eee.wiki/posts/python%E5%87%BD%E6%95%B0%E5%92%8C%E8%A3%85%E9%A5%B0%E5%99%A8/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="wtlinux" />

  <meta name="generator" content="Hugo 0.41" />
  <link rel="canonical" href="https://www.eee.wiki/posts/python%E5%87%BD%E6%95%B0%E5%92%8C%E8%A3%85%E9%A5%B0%E5%99%A8/" />
  <link rel="alternate" href="https://www.eee.wiki/index.xml" type="application/rss+xml" title="wtlinux">
  <script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/jquery-1.12.4.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="https://www.eee.wiki/css/main.css" />
  <link rel="stylesheet" href="https://www.eee.wiki/css/search.css" />
  
  

<meta name="baidu-site-verification" content="g8IYR9SNLF" />
<script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>

<link rel="stylesheet" href="https://www.eee.wiki/css/prism.css" />




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.eee.wiki/">wtlinux</a>
    </div>
    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Home" href="/home">Home</a>
              
              
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Categories</a>
              <div class="navlinks-children">
                
                
                  <a href="https://www.eee.wiki/tags/ops">ops</a>
                
                
                  <a href="https://www.eee.wiki/tags/dev">dev</a>
                
                
                  <a href="https://www.eee.wiki/tags/error">error</a>
                
                
                  <a href="https://www.eee.wiki/tags">Tags</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/about">About</a>
              
              
            </li>
          
        
          
            <li>
              <a title="talk" href="/tags/talk">talk</a>
              
              
            </li>
          
        

        

        
        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
      </div>
    </div>

  </div>
</nav>






    
  
  
  




  
    <div id="header-big-imgs" data-num-img=1 data-img-src-1="https://ws2.sinaimg.cn/large/006tNc79gy1ftcuzmw47tj30hi08rgs2.jpg" data-img-desc-1="Shanghai China| 2018-07-19T13:42:54&#43;08:00"></div>
  

  <header class="header-section has-img">
    
      <div class="intro-header big-img">
        
        
        <div class="container">
          <div class="row">
              <div class="col-lg-12 col-md-12 col-md-offset-0">
                
                <div class="post-heading">
                
                  
                     <h1>Python函数和装饰器</h1>
                     
                     
                  
                  
                  
                    
                      <hr class="small">
                      <span class="post-subheading">Python函数和装饰器</span>
                    
                  
                  
                    <span class="post-meta">
  
  Posted on July 19, 2018
  
  
</span>


                  
                
              </div>
            </div>
          </div>
        </div>
        <span class="img-desc" style="display: inline;"></span>
      </div>
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-12 col-md-12 col-md-offset-0">
            <div class="posts-heading">
                <h1 align="center">Python函数和装饰器</h1>
                
                  
                    <h2 align="center" class="posts-subheading">Python函数和装饰器</h2>
                  
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main" itemscope itemtype="http://schema.org/Article">
    <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            
            
              
            <article role="main" class="blog-post" itemprop="articleBody" id="content">
                
   
  <aside class="toc">
    <nav id="TableOfContents">
<ul>
<li><a href="#函数定义">函数定义</a></li>
<li><a href="#空函数">空函数</a></li>
<li><a href="#函数作用域">函数作用域</a></li>
<li><a href="#块级作用域">块级作用域</a></li>
<li><a href="#局部作用域">局部作用域</a></li>
<li><a href="#作用域链">作用域链</a></li>
<li><a href="#终极版作用域">终极版作用域</a></li>
<li><a href="#函数参数">函数参数</a></li>
<li><a href="#定义">定义：</a></li>
<li><a href="#默认参数">默认参数</a></li>
<li><a href="#可变参数">可变参数</a></li>
<li><a href="#关键字参数">关键字参数</a></li>
<li><a href="#组合参数">组合参数</a></li>
<li><a href="#小结">小结</a></li>
<li><a href="#高阶函数与函数返回值">高阶函数与函数返回值</a></li>
<li><a href="#高阶函数">高阶函数</a></li>
<li><a href="#函数返回值">函数返回值</a></li>
<li><a href="#lambda与匿名函数">lambda与匿名函数</a></li>
<li><a href="#map">map</a></li>
<li><a href="#filter">filter</a></li>
<li><a href="#reduce">reduce</a></li>
<li><a href="#lambda小结">lambda小结</a></li>
<li><a href="#装饰器">装饰器</a></li>
<li><a href="#格式">格式</a></li>
<li><a href="#装饰器原理">装饰器原理</a></li>
<li><a href="#带参数的装饰器">带参数的装饰器</a></li>
<li><a href="#装饰器应用">装饰器应用</a></li>
<li><a href="#装饰器小结">装饰器小结</a></li>
<li><a href="#开放封闭原则">开放封闭原则</a></li>
<li><a href="#闭包概念">闭包概念</a></li>
<li><a href="#闭包的作用">闭包的作用</a></li>
</ul>
</nav>
  </aside>
   

                

<h1 id="函数定义">函数定义</h1>

<p>在Python中，定义一个函数要使用def语句，依次写出函数名、括号、括号中的参数和冒号<code>:</code>，然后，在缩进块中编写函数体，函数的返回值用return语句返回。
我们以自定义一个求绝对值的my_abs函数为例：</p>

<pre><code>def my_abs(x):
    if x &gt;= 0:
        return x
    else:
        return -x
</code></pre>

<p>请自行测试并调用my_abs看看返回结果是否正确。</p>

<p>请注意，函数体内部的语句在执行时，一旦执行到return时，函数就执行完毕，并将结果返回。因此，函数内部通过条件判断和循环可以实现非常复杂的逻辑。</p>

<p>如果没有return语句，函数执行完毕后也会返回结果，只是结果为None。</p>

<p>return None可以简写为return。</p>

<h1 id="空函数">空函数</h1>

<p>如果想定义一个什么事也不做的空函数，可以用pass语句：</p>

<pre><code>def nop():
    pass
</code></pre>

<p>pass语句什么都不做，那有什么用？实际上pass可以用来作为占位符，比如现在还没想好怎么写函数的代码，就可以先放一个pass，让代码能运行起来。</p>

<p>pass还可以用在其他语句里，比如：</p>

<pre><code>if age &gt;= 18:
    pass
</code></pre>

<p>缺少了pass，代码运行就会有语法错误。</p>

<h1 id="函数作用域">函数作用域</h1>

<h1 id="块级作用域">块级作用域</h1>

<pre><code>if 1 == 1:
    name = &quot;lzl&quot;

print(name)


for i in range(10):
    age = i

print(age)
</code></pre>

<p>运行结果：</p>

<pre><code>lzl
9
</code></pre>

<p>代码执行成功，没有问题；在Java/C#中，执行上面的代码会提示<code>name</code>，<code>age</code>没有定义，而在Python中可以执行成功，这是因为在<code>Python</code>中是没有块级作用域的，代码块里的变量，外部可以调用，所以可运行成功；</p>

<h1 id="局部作用域">局部作用域</h1>

<pre><code>def  func():
    name = &quot;lzl&quot;

print(name)
</code></pre>

<p>运行结果：</p>

<pre><code>Traceback (most recent call last):
  File &quot;test.py&quot;, line 4, in &lt;module&gt;
    print(name)
NameError: name 'name' is not defined

</code></pre>

<p>运行报错，我相信这个大家都能理解，name变量只在func()函数内部中生效，所以在全局中是没法调用的；对上面代码做个简单调整，再看看结果如何?</p>

<pre><code>def  func():
    name = &quot;lzl&quot;

func()          #执行函数
print(name)
</code></pre>

<p>运行结果：</p>

<pre><code>Traceback (most recent call last):
  File &quot;test.py&quot;, line 5, in &lt;module&gt;
    print(name)
NameError: name 'name' is not defined
</code></pre>

<p>执行依然报错，还是回到刚才那句话：即使执行了一下函数，name的作用域也只是在函数内部，外部依然无法进行调用；</p>

<h1 id="作用域链">作用域链</h1>

<pre><code>name = &quot;lzl&quot;
def f1():
    name = &quot;Eric&quot;
    def f2():
        name = &quot;Snor&quot;
        print(name)
    f2()
f1()
</code></pre>

<p>运行结果：</p>

<pre><code>Snor
</code></pre>

<p>学过函数，肯定知道最后f1()执行完会输出Snor；我们先记住一个概念，Python中有作用域链，变量会由内到外找，先去自己作用域去找，自己没有再去上级去找，直到找不到报错</p>

<h1 id="终极版作用域">终极版作用域</h1>

<pre><code>name = &quot;lzl&quot;

def f1():
    print(name)

def f2():
    name = &quot;eric&quot;
    f1()

f2()

</code></pre>

<p>想想最后f2()执行结果是打印“lzl”呢，还是打印“eric”？记住自己的答案，现在先不把答案贴出来，先看看下面这段代码：</p>

<pre><code>name = &quot;lzl&quot;

def f1():
    print(name)

def f2():
    name = &quot;eric&quot;
    return f1

ret = f2()
ret()

</code></pre>

<p>运行结果</p>

<pre><code>lzl
</code></pre>

<p>执行结果为“lzl”，分析下上面的代码，f2()执行结果为函数f1的内存地址，即ret=f1；执行ret()等同于执行f1()，执行f1()时与f2()没有任何关系，name=“lzl”与f1()在一个作用域链，函数内部没有变量是会向外找，所以此时变量name值为“lzl”；理解了这个，那么刚才没给出答案的那个终极代码你也知道答案了</p>

<pre><code>name = &quot;lzl&quot;
def f1():
    print(name)
def f2():
    name = &quot;eric&quot;
    f1()
f2()
</code></pre>

<p>运行结果：</p>

<pre><code>lzl
</code></pre>

<p>是的，输出的是“lzl”，记住在函数未执行之前，作用域已经形成了，作用域链也生成了.</p>

<h1 id="函数参数">函数参数</h1>

<h1 id="定义">定义：</h1>

<p>定义函数的时候，我们把参数的名字和位置确定下来，函数的接口定义就完成了。对于函数的调用者来说，只需要知道如何传递正确的参数，以及函数将返回什么样的值就够了，函数内部的复杂逻辑被封装起来，调用者无需了解。
Python的函数定义非常简单，但灵活度却非常大。除了正常定义的必选参数外，还可以使用默认参数、可变参数和关键字参数，使得函数定义出来的接口，不但能处理复杂的参数，还可以简化调用者的代码</p>

<h1 id="默认参数">默认参数</h1>

<p>我们仍以具体的例子来说明如何定义函数的默认参数。先写一个计算x2的函数：</p>

<pre><code>def f1(x):
    return x * x

ret = f1(5)
print(ret)
</code></pre>

<p>运行结果</p>

<pre><code>25
</code></pre>

<p>当我们调用power函数时，必须传入有且仅有的一个参数x：
现在，如果我们要计算x3怎么办？可以再定义一个power3函数，但是如果要计算x4、x5……怎么办？我们不可能定义无限多个函数。</p>

<pre><code>def power(x, n):
    s = 1
    while n &gt; 0:
        n = n - 1
        s = s * x
    return s
</code></pre>

<p>对于这个修改后的power函数，可以计算任意n次方：</p>

<pre><code>&gt;&gt;&gt; power(5, 2)
25
&gt;&gt;&gt; power(5, 3)
125
</code></pre>

<p>但是，旧的调用代码失败了，原因是我们增加了一个参数，导致旧的代码无法正常调用：</p>

<pre><code>&gt;&gt;&gt; power(5)
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
TypeError: power() takes exactly 2 arguments (1 given)
</code></pre>

<p>这个时候，默认参数就排上用场了。由于我们经常计算x2，所以，完全可以把第二个参数n的默认值设定为2：</p>

<pre><code>def power(x, n=2):
    s = 1
    while n &gt; 0:
        n = n - 1
        s = s * x
    return s
</code></pre>

<p>这样，当我们调用power(5)时，相当于调用power(5, 2)：</p>

<pre><code>&gt;&gt;&gt; power(5)
25
&gt;&gt;&gt; power(5, 2)
25
</code></pre>

<p>而对于n &gt; 2的其他情况，就必须明确地传入n，比如power(5, 3)。</p>

<p>从上面的例子可以看出，默认参数可以简化函数的调用。设置默认参数时，有几点要注意：</p>

<p>一是必选参数在前，默认参数在后，否则Python的解释器会报错（思考一下为什么默认参数不能放在必选参数前面）；
二是如何设置默认参数。
当函数有多个参数时，把变化大的参数放前面，变化小的参数放后面。变化小的参数就可以作为默认参数。
使用默认参数有什么好处？最大的好处是能降低调用函数的难度。</p>

<h1 id="可变参数">可变参数</h1>

<p>在Python函数中，还可以定义可变参数。顾名思义，可变参数就是传入的参数个数是可变的，可以是1个、2个到任意个，还可以是0个。
我们以数学题为例子，给定一组数字a，b，c……，请计算a2 + b2 + c2 + ……。
要定义出这个函数，我们必须确定输入的参数。由于参数个数不确定，我们首先想到可以把a，b，c……作为一个list或tuple传进来，这样，函数可以定义如下：</p>

<pre><code>def calc(numbers):
    sum = 0
    for n in numbers:
        sum = sum + n * n
    return sum
</code></pre>

<p>但是调用的时候，需要先组装出一个list或tuple：</p>

<pre><code>&gt;&gt;&gt; calc([1, 2, 3])
14
&gt;&gt;&gt; calc((1, 3, 5, 7))
84
</code></pre>

<p>如果利用可变参数，调用函数的方式可以简化成这样：</p>

<pre><code>&gt;&gt;&gt; calc(1, 2, 3)
14
&gt;&gt;&gt; calc(1, 3, 5, 7)
84
</code></pre>

<p>所以，我们把函数的参数改为可变参数：</p>

<pre><code>def calc(*numbers):
    sum = 0
    for n in numbers:
        sum = sum + n * n
    return sum
</code></pre>

<p>定义可变参数和定义list或tuple参数相比，仅仅在参数前面加了一个*号。在函数内部，参数numbers接收到的是一个tuple，因此，函数代码完全不变。但是，调用该函数时，可以传入任意个参数，包括0个参数：</p>

<pre><code>&gt;&gt;&gt; calc(1, 2)
5
&gt;&gt;&gt; calc()
0
</code></pre>

<p>如果已经有一个list或者tuple，要调用一个可变参数怎么办？可以这样做：</p>

<pre><code>&gt;&gt;&gt; nums = [1, 2, 3]
&gt;&gt;&gt; calc(nums[0], nums[1], nums[2])
14
</code></pre>

<p>这种写法当然是可行的，问题是太繁琐，所以Python允许你在list或tuple前面加一个*号，把list或tuple的元素变成可变参数传进去：</p>

<pre><code>&gt;&gt;&gt; nums = [1, 2, 3]
&gt;&gt;&gt; calc(*nums)
14
</code></pre>

<p>这种写法相当有用，而且很常见。</p>

<h1 id="关键字参数">关键字参数</h1>

<p>可变参数允许你传入0个或任意个参数，这些可变参数在函数调用时自动组装为一个tuple。而关键字参数允许你传入0个或任意个含参数名的参数，这些关键字参数在函数内部自动组装为一个dict。请看示例：</p>

<pre><code>def person(name, age, **kw):
    print 'name:', name, 'age:', age, 'other:', kw
</code></pre>

<p>函数person除了必选参数name和age外，还接受关键字参数kw。在调用该函数时，可以只传入必选参数：</p>

<pre><code>&gt;&gt;&gt; person('Michael', 30)
name: Michael age: 30 other: {}
</code></pre>

<p>也可以传入任意个数的关键字参数：</p>

<pre><code>&gt;&gt;&gt; person('Bob', 35, city='Beijing')
name: Bob age: 35 other: {'city': 'Beijing'}
&gt;&gt;&gt; person('Adam', 45, gender='M', job='Engineer')
name: Adam age: 45 other: {'gender': 'M', 'job': 'Engineer'}
</code></pre>

<p>关键字参数有什么用？它可以扩展函数的功能。比如，在person函数里，我们保证能接收到name和age这两个参数，但是，如果调用者愿意提供更多的参数，我们也能收到。试想你正在做一个用户注册的功能，除了用户名和年龄是必填项外，其他都是可选项，利用关键字参数来定义这个函数就能满足注册的需求。</p>

<p>和可变参数类似，也可以先组装出一个dict，然后，把该dict转换为关键字参数传进去：</p>

<pre><code>&gt;&gt;&gt; kw = {'city': 'Beijing', 'job': 'Engineer'}
&gt;&gt;&gt; person('Jack', 24, city=kw['city'], job=kw['job'])
name: Jack age: 24 other: {'city': 'Beijing', 'job': 'Engineer'}
</code></pre>

<p>当然，上面复杂的调用可以用简化的写法：</p>

<pre><code>&gt;&gt;&gt; kw = {'city': 'Beijing', 'job': 'Engineer'}
&gt;&gt;&gt; person('Jack', 24, **kw)
name: Jack age: 24 other: {'city': 'Beijing', 'job': 'Engineer'}
</code></pre>

<h1 id="组合参数">组合参数</h1>

<p>在Python中定义函数，可以用必选参数、默认参数、可变参数和关键字参数，这4种参数都可以一起使用，或者只用其中某些，但是请注意，参数定义的顺序必须是：必选参数、默认参数、可变参数和关键字参数。</p>

<p>比如定义一个函数，包含上述4种参数：</p>

<pre><code>def func(a, b, c=0, *args, **kw):
    print 'a =', a, 'b =', b, 'c =', c, 'args =', args, 'kw =', kw
</code></pre>

<p>在函数调用的时候，Python解释器自动按照参数位置和参数名把对应的参数传进去。</p>

<pre><code>&gt;&gt;&gt; func(1, 2)
a = 1 b = 2 c = 0 args = () kw = {}
&gt;&gt;&gt; func(1, 2, c=3)
a = 1 b = 2 c = 3 args = () kw = {}
&gt;&gt;&gt; func(1, 2, 3, 'a', 'b')
a = 1 b = 2 c = 3 args = ('a', 'b') kw = {}
&gt;&gt;&gt; func(1, 2, 3, 'a', 'b', x=99)
a = 1 b = 2 c = 3 args = ('a', 'b') kw = {'x': 99}
</code></pre>

<p>最神奇的是通过一个tuple和dict，你也可以调用该函数：</p>

<pre><code>&gt;&gt;&gt; args = (1, 2, 3, 4)
&gt;&gt;&gt; kw = {'x': 99}
&gt;&gt;&gt; func(*args, **kwargs)
a = 1 b = 2 c = 3 args = (4,) kw = {'x': 99}
</code></pre>

<p>所以，对于任意函数，都可以通过类似func(*args, **kw)的形式调用它，无论它的参数是如何定义的。</p>

<h1 id="小结">小结</h1>

<p>Python的函数具有非常灵活的参数形态，既可以实现简单的调用，又可以传入非常复杂的参数。</p>

<p>默认参数一定要用不可变对象，如果是可变对象，运行会有逻辑错误！</p>

<p>要注意定义可变参数和关键字参数的语法：</p>

<p>*args是可变参数，args接收的是一个tuple；</p>

<p>**kwargs是关键字参数，kw接收的是一个dict。</p>

<p>以及调用函数时如何传入可变参数和关键字参数的语法：</p>

<p>可变参数既可以直接传入：func(1, 2, 3)，又可以先组装list或tuple，再通过<em>args传入：func(</em>(1, 2, 3))；</p>

<p>关键字参数既可以直接传入：func(a=1, b=2)，又可以先组装dict，再通过**kw传入：func(**{&lsquo;a&rsquo;: 1, &lsquo;b&rsquo;: 2})。</p>

<p>使用*args和**kwargs是Python的习惯写法，当然也可以用其他参数名，但最好使用习惯用法。</p>

<h1 id="高阶函数与函数返回值">高阶函数与函数返回值</h1>

<h1 id="高阶函数">高阶函数</h1>

<ul>
<li><p>高阶函数就是可以接收<code>函数对象</code>作为参数的函数</p>

<h1 id="函数返回值">函数返回值</h1></li>

<li><p>执行完函数之后返回的结果就是函数返回值
对于函数的返回值可以用<code>return</code>进行返回，对返回值进行print就能拿到返回结果。
函数是一个功能块，该功能是否成功执行，需要通过返回值来告诉调用者
return值返回之后后面的代码将不再执行</p>

<h1 id="lambda与匿名函数">lambda与匿名函数</h1>

<p>lambda就是简单函数的表达式，也可以说它是一个匿名函数。然而在使用它或是阅读Lambda代码的时候，却显得并不那么容易。因为它匿名，因为它删减了一些必要的说明信息（比如方法名）。下面就来说说Lambda是如何进行转换和工作的吧。</p></li>
</ul>

<p>举个例子：</p>

<pre><code>def func(a):
    a += 1
    return a
b = func(4)
print(b)

c = lambda d: d+1   # 使用lambda就可以一行搞定
f = c(4)
print(f)
</code></pre>

<p>Python中，也有几个定义好的全局函数方便使用的，filter, map, reduce</p>

<pre><code>&gt;&gt;&gt; foo = [2, 18, 9, 22, 17, 24, 8, 12, 27]
&gt;&gt;&gt;
&gt;&gt;&gt; print filter(lambda x: x % 3 == 0, foo)
[18, 9, 24, 12, 27]
&gt;&gt;&gt;
&gt;&gt;&gt; print map(lambda x: x * 2 + 10, foo)
[14, 46, 28, 54, 44, 58, 26, 34, 64]
&gt;&gt;&gt;
&gt;&gt;&gt; print reduce(lambda x, y: x + y, foo)
139
</code></pre>

<p>上面例子中的map的作用，非常简单清晰。但是，Python是否非要使用lambda才能做到这样的简洁程度呢？在对象遍历处理方面，其实Python的for..in..if语法已经很强大，并且在易读上胜过了lambda。
比如上面map的例子，可以写成：
print [x * 2 + 10 for x in foo]
非常的简洁，易懂。
filter的例子可以写成：
print [x for x in foo if x % 3 == 0]
同样也是比lambda的方式更容易理解。
通过此例子，我们发现，lambda的使用大量简化了代码，使代码简练清晰。但是值得注意的是，这会在一定程度上降低代码的可读性。如果不是非常熟悉python的人或许会对此感到不可理解。</p>

<h1 id="map">map</h1>

<p>遍历序列，对序列中每个元素进行操作，最终获取新的序列。</p>

<pre><code>#  每个元素增加y100
li = [11, 22, 33]
new_list = map(lambda a: a + 100, li)
# 两个列表对应元素相加
li = [11, 22, 33]
sl = [1, 2, 3]
new_list = map(lambda a, b: a + b, li, sl)
</code></pre>

<h1 id="filter">filter</h1>

<p>对于序列中的元素进行筛选，最终获取符合条件的序列</p>

<pre><code># 获取列表中大于12的所有元素集合

li = [11, 22, 33]

new_list = filter(lambda arg: arg &gt; 22, li)

#filter第一个参数为空，将获取原来序列

</code></pre>

<h1 id="reduce">reduce</h1>

<p>对于序列内所有元素进行累计操作</p>

<pre><code>#获取数列所有元素的和
li = [11, 22, 33]

result = reduce(lambda arg1, arg2: arg1 + arg2, li)

# reduce的第一个参数，函数必须要有两个参数
# reduce的第二个参数，要循环的序列
# reduce的第三个参数，初始值
</code></pre>

<h1 id="lambda小结">lambda小结</h1>

<p>lambda 定义了一个匿名函数
lambda 并不会带来程序运行效率的提高，只会使代码更简洁
如果可以使用for&hellip;in&hellip;if来完成的，坚决不用lambda。
如果使用lambda，lambda内不要包含循环，如果有，我宁愿定义函数来完成，使代码获得可重用性和更好的可读性
总结：lambda 是为了减少单行函数的定义而存在的。</p>

<h1 id="装饰器">装饰器</h1>

<h1 id="格式">格式</h1>

<pre><code>def timer(func):
    def inner(*args,**kwargs):
        '''执行函数之前要做的'''
        re = func(*args,**kwargs)
        '''执行函数之后要做的'''
        return re
    return inner
</code></pre>

<h1 id="装饰器原理">装饰器原理</h1>

<ul>
<li>装饰器是函数，只不过该函数可以具有特殊的含义，装饰器用来装饰函数或类，使用装饰器可以在函数执行前和执行后添加相应操作。</li>
</ul>

<pre><code>def wrapper(func):
    def result():
        print 'before'
        func()
        print 'after'
    return result

@wrapper
def foo():
    print 'foo'
</code></pre>

<h1 id="带参数的装饰器">带参数的装饰器</h1>

<pre><code>#!/usr/bin/env python
#coding:utf-8

def Before(request,kargs):
    print 'before'
    
def After(request,kargs):
    print 'after'


def Filter(before_func,after_func):
    def outer(main_func):
        def wrapper(request,kargs):
            
            before_result = before_func(request,kargs)
            if(before_result != None):
                return before_result;
            
            main_result = main_func(request,kargs)
            if(main_result != None):
                return main_result;
            
            after_result = after_func(request,kargs)
            if(after_result != None):
                return after_result;
            
        return wrapper
    return outer
    
@Filter(Before, After)
def Index(request,kargs):
    print 'index'
    
    
if __name__ == '__main__':
    Index(1,2)
</code></pre>

<h1 id="装饰器应用">装饰器应用</h1>

<pre><code>import functools


def wrapper(func):
    @functools.wraps(func)
    def wrapper():
        print 'before'
        func()
        print 'after'
    return wrapper

@wrapper
def foo():
    print 'foo'
</code></pre>

<h1 id="装饰器小结">装饰器小结</h1>

<p>可以装饰具有处理n个参数的函数的装饰器
一个函数可以被多个装饰器装饰
装饰器内的函数代指了原函数，注意其只是代指而非相等，原函数的元信息没有被赋值到装饰器函数内部。例如：函数的注释信息
如果使用@functools.wraps装饰装饰器内的函数，那么就会代指元信息和函数。
装饰器的本质：一个闭包函数
装饰器的功能：在不修改原函数及其调用方式的情况下对原函数功能进行扩展</p>

<pre><code># 无元信息
def outer(func):
    def inner(*args, **kwargs):
        print(inner.__doc__)  # None
        return func()
    return inner

@outer
def function():
    &quot;&quot;&quot;
    asdfasd
    :return:
    &quot;&quot;&quot;
    print('func')


# 含元信息
def outer(func):
    @functools.wraps(func)
    def inner(*args, **kwargs):
        print(inner.__doc__)  # None
        return func()
    return inner

@outer
def function():
    &quot;&quot;&quot;
    asdfasd
    :return:
    &quot;&quot;&quot;
    print('func')


</code></pre>

<h1 id="开放封闭原则">开放封闭原则</h1>

<p>1.对扩展是开放的
　　为什么要对扩展开放呢？
　　我们说，任何一个程序，不可能在设计之初就已经想好了所有的功能并且未来不做任何更新和修改。所以我们必须允许代码扩展、添加新功能。</p>

<p>2.对修改是封闭的
　　为什么要对修改封闭呢？
　　因为我们写的一个函数，很有可能已经交付给其他人使用了，如果这个时候我们对其进行了修改，很有可能影响其他已经在使用该函数的用户。
装饰器完美的遵循了这个开放封闭原则。</p>

<h1 id="闭包概念">闭包概念</h1>

<pre><code>“闭包”的意思，望文知意，可以形象的把它理解为一个封闭的包裹，这个包裹就是一个函数，当然还有函数内部对应的逻辑，包裹里面的东西就是自由变量，自由变量可以在随着包裹到处游荡。当然还得有个前提，这个包裹是被创建出来的。
在通过Python的语言介绍一下，一个闭包就是你调用了一个函数A，这个函数A返回了一个函数B给你。这个返回的函数B就叫做闭包。你在调用函数A的时候传递的参数就是自由变量。
</code></pre>

<p>举个栗子：</p>

<pre><code>def func(name):
    def inner_func(age):
        print 'name:', name, 'age:', age
    return inner_func

bb = func('the5fire')
bb(26)  # &gt;&gt;&gt; name: the5fire age: 26
</code></pre>

<p>这里面调用func的时候就产生了一个闭包——inner_func,并且该闭包持有自由变量——name，因此这也意味着，当函数func的生命周期结束之后，name这个变量依然存在，因为它被闭包引用了，所以不会被回收。
另外再说一点，闭包并不是Python中特有的概念，所有把函数做为一等公民的语言均有闭包的概念。不过像Java这样以class为一等公民的语言中也可以使用闭包，只是它得用类或接口来实现。</p>

<h1 id="闭包的作用">闭包的作用</h1>

<p>闭包的最大特点是可以将父函数的变量与内部函数绑定，并返回绑定变量后的函数（也即闭包），此时即便生成闭包的环境（父函数）已经释放，闭包仍然存在，这个过程很像类（父函数）生成实例（闭包），不同的是父函数只在调用时执行，执行完毕后其环境就会释放，而类则在文件执行时创建，一般程序执行完毕后作用域才释放，因此对一些需要重用的功能且不足以定义为类的行为，使用闭包会比使用类占用更少的资源，且更轻巧灵活。
闭包还有很多其他功能，比如用于封装等，另外，闭包有效的减少了函数参数的数目，这对并行计算非常有价值，比如可以让每台电脑负责一个函数，然后串起来，实现流水化的作业等。</p>

            </article>

            <ul class="pager blog-pager">
                
                <li class="previous">
                    <a href="https://www.eee.wiki/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/" data-toggle="tooltip" data-placement="top" title="Python文件处理">&larr; Previous Post</a>
                </li>
                 
                <li class="next">
                    <a href="https://www.eee.wiki/posts/python%E9%80%92%E5%BD%92%E5%92%8C%E5%8F%8D%E5%B0%84/" data-toggle="tooltip" data-placement="top" title="Python递归和反射">Next Post &rarr;</a>
                </li>
                
            </ul>
            
            <div>
                 
                <h2>See Also</h2>
                <ul>
                    
                    <li><a href="/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/">Python文件处理</a></li>
                    
                    <li><a href="/posts/python%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">Python常用数据类型</a></li>
                    
                    <li><a href="/posts/python%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/">Python流程控制</a></li>
                    
                    <li><a href="/posts/%E5%B8%B8%E8%A7%81nginx%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5/">常见nginx故障排查</a></li>
                    
                    <li><a href="/posts/kafka%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Kafka常用命令</a></li>
                    
                </ul>
                
            </div>
            
            
            
              
            </div>
            
            
        </div>
    </div>
    </section>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
        <img src="https://ws3.sinaimg.cn/large/006tKfTcgy1ft8a0o1hlcj30ax0azjt4.jpg">
          
              <li>
                <a href="mailto:976199267@qq.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/wtli/wtli.github.io" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
        &copy;2017-2018
          
            
              wangtian
            
          
          
          
            &nbsp;&bull;&nbsp;
            <a href="https://www.eee.wiki/">wtlinux</a>
          
        </p>
        <p class="credits theme-by text-muted">
        <a href="http://www.wtlinux.com">wtlinux.com</a>&nbsp;&bull;&nbsp;<a href="https://www.eee.wiki">eee.wiki</a>&nbsp;&bull;&nbsp;<a href="https://www.bldz.com">www.bldz.com</a>
        </p>

        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.41</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/rootsongjc/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>


<script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/bootstrap.min.js"></script>
<script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/photoswipe-ui-default.min.js"></script>
<script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/photoswipe.min.js"></script>
<script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/auto-render.min.js"></script>
<script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/main.js"></script>
<script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/prism.js"></script>
<script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/katex.min.js"></script>
<script> renderMathInElement(document.body); </script>







  </body>
</html>

